<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!-- saved from url=(0079)http://www.ibexpert.net/ibe/index.php?n=Doc.InterBaseAndJavaMakingTheConnection -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
	<title>the database experts Doc/InterBase and Java: making the connection</title>
	<meta name="generator" content="PmWiki">
	<link rel="stylesheet" type="text/css" href="./the database experts Doc InterBase and Java  making the connection_files/green_muted.css" media="screen" title="style (screen)">
	<link rel="stylesheet" type="text/css" href="./the database experts Doc InterBase and Java  making the connection_files/style.css" media="screen" title="style (screen)">
	<!--[if lte IE 7]><link rel="stylesheet" type="text/css" href="http://www.ibexpert.net/ibe/pub/skins/N3/mainstyle/ie7.css" media="screen" title="style (screen)" /><![endif]-->
<!--HTMLHeader--><style type="text/css"><!--.editconflict { color:green; 
  font-style:italic; margin-top:1.33em; margin-bottom:1.33em; }
#head .sitetitle a{height:108px; background: url(http://ibexpert.net/ibe/uploads/Main/ibelogo_small.gif) left 16px no-repeat} #head .sitetitle a, #head .sitetag{padding-left: 137px} 
  table.markup { border:2px dotted #ccf; width:90%; }
  td.markup1, td.markup2 { padding-left:10px; padding-right:10px; }
  table.vert td.markup1 { border-bottom:1px solid #ccf; }
  table.horiz td.markup1 { width:23em; border-right:1px solid #ccf; }
  table.markup caption { text-align:left; }
  div.faq p, div.faq pre { margin-left:2em; }
  div.faq p.question { margin:1em 0 0.75em 0; font-weight:bold; }
   
    .frame 
      { border:1px solid #cccccc; padding:4px; background-color:#f9f9f9; }
    .lfloat { float:left; margin-right:0.5em; }
    .rfloat { float:right; margin-left:0.5em; }
a.varlink { text-decoration:none; }

--></style>  <meta name="robots" content="index,follow">
<meta name="keywords" content="InterBase and Java: making the connection, The JDBC driver, Connecting to a database, Testing the connection: A simple SELECT, Closing the connection">
<meta name="description" content="Database technology articles">

</head>

<body>
	<div id="head">
		<!--PageHeaderFmt-->
		<h1 class="sitetitle"><a class="urllink" href="http://www.ibexpert.net/ibe/index.php" rel="nofollow">the database experts</a></h1>
<div class="sitetag">
</div>
 
		<!--/PageHeaderFmt-->                                   
	</div>

	<div class="main">

		<div id="content">	<!--DJG: content2-->
			<!--PageTitleGroupFmt-->
			<!--/PageTitleGroupFmt-->
			<!--PageTitleFmt--><!--/PageTitleFmt-->
			<!--PageText-->
<div id="wikitext">
<p class="vspace"><a name="t" id="t"></a>
</p>
<p class="vspace" style="text-align: center;"><span class="trail"><span class="wikitrail">&lt;&lt; <a class="wikilink" href="http://www.ibexpert.net/ibe/index.php?n=Doc.UsingApachePHPAndInterBaseToDevelopWebsites">Using Apache, PHP and InterBase to develop websites</a> | <a class="wikilink" href="http://www.ibexpert.net/ibe/index.php?n=Doc.DatabaseTechnologyArticles">Database technology articles</a> | <a class="wikilink" href="http://www.ibexpert.net/ibe/index.php?n=Doc.InterBaseAndJavaStoringAndRetrievingBLOBData">InterBase and Java: storing and retrieving BLOB data</a> &gt;&gt;</span></span>
</p>
<div class="vspace"></div><div class="frame rfloat" style="font-size: smaller;"> 
<p class="vspace"><a href="http://www.ibexpert.net/ibe/index.php?n=Doc.InterBaseAndJavaMakingTheConnection#InterBaseAndJava">InterBase<sup>®</sup> and Java<sup>®</sup>: making the connection</a>
</p><ol><li><a href="http://www.ibexpert.net/ibe/index.php?n=Doc.InterBaseAndJavaMakingTheConnection#TheJDBCDriver">The JDBC driver</a>
</li><li><a href="http://www.ibexpert.net/ibe/index.php?n=Doc.InterBaseAndJavaMakingTheConnection#ConnectingToA">Connecting to a database</a>
</li><li><a href="http://www.ibexpert.net/ibe/index.php?n=Doc.InterBaseAndJavaMakingTheConnection#TestingTheConnection">Testing the connection: A simple <code>SELECT</code></a>
</li><li><a href="http://www.ibexpert.net/ibe/index.php?n=Doc.InterBaseAndJavaMakingTheConnection#ClosingTheConnection">Closing the connection</a>
</li></ol><div class="vspace"></div></div>
<div class="vspace"></div><h1><a name="InterBaseAndJava" id="InterBaseAndJava"></a><span class="wikiword">InterBase</span><sup>®</sup> and Java<sup>®</sup>: making the connection</h1>
<p><span style="color: green;"><span style="font-size:83%"><em>By Joe Shevland</em></span></span>
</p>
<p class="vspace">This section describes how to connect to an <span class="wikiword">InterBase</span><sup>®</sup> database using the Java<sup>®</sup> platform and JDBC (Java<sup>®</sup> <span class="wikiword">DataBase</span> Connectivity). <span class="wikiword">InterBase</span><sup>®</sup> 6 and Interclient 1.6 are used in these examples, however the same information may apply to older or more recent versions. The Java<sup>®</sup> 2 platform has been used throughout this section however the code should also be compatible with JRE 1.1 environments. 
</p>
<div class="vspace"></div><h2><a name="TheJDBCDriver" id="TheJDBCDriver"></a>The JDBC driver</h2>
<p>JDBC provides a uniform methodology for accessing <a class="wikilink" href="http://www.ibexpert.net/ibe/index.php?n=Doc.RDBMS">relational databases</a>, and makes use of vendor provided drivers to hide the variances in the different database products. <span class="wikiword">InterBase</span><sup>®</sup> JDBC access also uses the standard JDBC extension package (<code>Javax.sql.*</code>) which is provided as a standalone JAR package. 
</p>
<p class="vspace">The <span class="wikiword">InterBase</span><sup>®</sup> JDBC driver is bundled in a JAR file called <code>interclient.jar</code> which is available as part of the Interclient download. 
</p>
<p class="vspace">The JDBC standard extension package is available from Sun's Java<sup>®</sup> website and is bundled in a JAR file called <code>jdbc2_0-stdext.jar</code>. 
</p>
<p class="vspace">In order to successfully connect to an <span class="wikiword">InterBase</span><sup>®</sup> database, both of these JAR files will need to be in the <code>CLASSPATH</code> of your application or applet e.g. 
</p>
<div class="vspace"></div><pre> set CLASSPATH=.:interclient.jar:jdbc2_0-stdext.jar:&lt;...&gt;
 SET CLASSPATH=.;interclient.jar;jdbc2_0-stdext.jar;&lt;...&gt; (Windows version)
</pre><p class="vspace"><span class="wikiword">InterServer</span> will also need to be installed and running on the server to which you are connecting. 
</p>
<p class="vspace" style="text-align: center;"><a href="http://www.ibexpert.net/ibe/index.php?n=Doc.InterBaseAndJavaMakingTheConnection#t">back to top of page</a> <br clear="all">
</p>
<div class="vspace"></div><h2><a name="ConnectingToA" id="ConnectingToA"></a>Connecting to a database</h2>
<p>Once the required <code>JAR</code> files are located in your <code>CLASSPATH</code> and the necessary software is running on the server, it is a simple matter to connect to a local or remote <span class="wikiword">InterBase</span><sup>®</sup> server. See the example code below for the relevant details. 
</p>
<p class="vspace"><strong>Example 1.0: Creating a connection</strong>
</p>
<div class="vspace"></div><pre> import Java<sup>®</sup>.sql.*;
 import <span class="wikiword">InterBase</span><sup>®</sup>.interclient.<span class="wikiword">DataSource</span>;

 ...

 <span class="wikiword">DataSource</span> dataSource = new <span class="wikiword">InterBase</span><sup>®</sup>.interclient.<span class="wikiword">DataSource</span>();

 try {

 // Set the standard properties
 /* set the network protocol */
 dataSource.setNetworkProtocol("jdbc:<span class="wikiword">InterBase</span><sup>®</sup>:"); 
 /* the hostname or IP address of the server */
 dataSource.setServerName("dbserver.domain.com"); 
 /* the full path to your database file */
 dataSource.setDatabaseName("/data/mydb.gdb");
 /* a descriptive name */
 dataSource.setDataSourceName("<span class="wikiword">SomeName</span>"); 
 /* a descriptive comment */
 dataSource.setDescription("<span class="wikiword">SomeDescription</span>");
 /* the TCP port Interclient listens on by default */ 
 dataSource.setPortNumber(3060); 
 /* set the <span class="wikiword">InterBase</span><sup>®</sup> role to use */
 dataSource.setRoleName("<span class="wikiword">MyRole</span>"); 
 /* set the login timeout to 10 seconds */
 dataSource.setLoginTimeout(10);  

 // Set the non-standard properties
 /* Perform a sweep when connecting */
 dataSource.setSweepOnConnect(false); 

 // The following line actually starts up the database connection:
 Connection con = dataSource.getConnection(con_user,con_pw);

 } catch ( <span class="wikiword">SQLException</span> se ) {

 // Report the problem to the standard error stream:
 System.err.println("Exception creating the database connection: "+se);

 }
</pre><p class="vspace">Instead of using the new <code><span class="wikiword">DataSource</span></code> approach, you can also use the older method of registering a JDBC driver with the <span class="wikiword">DriverManager</span> and calling <code>getConnection()</code>. A brief example follows. Note that this approach does not allow you to specify an <span class="wikiword">InterBase</span><sup>®</sup> role (I may have spotted somewhere in the docs that you can do this by specifying a system property or some such: anyone?). 
</p>
<div class="vspace"></div><pre> import Java<sup>®</sup>.sql.*;

 ...

 try {

 // Resolve the JDBC driver class:
 Class.forName("<span class="wikiword">InterBase</span><sup>®</sup>.interclient.Driver");

 // The following line actually starts up the database connection:
 Connection con = <span class="wikiword">DriverManager</span>.getConnection
 ("jdbc:<span class="wikiword">InterBase</span><sup>®</sup>://localhost/data/mydb.gdb","SYSDBA","masterkey");

 } catch ( <span class="wikiword">ClassNotFoundException</span> cnfe ) {

 // Report the problem to the standard error stream:
 System.err.println("Couldn't locate the driver class: "+cnfe);

 } catch ( <span class="wikiword">SQLException</span> se ) {

 // Report the problem to the standard error stream:
 System.err.println("Exception creating the database connection: "+se);

 }
</pre><p class="vspace" style="text-align: center;"><a href="http://www.ibexpert.net/ibe/index.php?n=Doc.InterBaseAndJavaMakingTheConnection#t">back to top of page</a> <br clear="all">
</p>
<div class="vspace"></div><h2><a name="TestingTheConnection" id="TestingTheConnection"></a>Testing the connection: A simple <code>SELECT</code></h2>
<p>Now that you have a successful connection to the database, the following code snippet shows you how to perform a simple <a class="wikilink" href="http://www.ibexpert.net/ibe/index.php?n=Doc.DataRetrieval#SELECT"><code>SELECT</code> statement</a> and retrieve the results. You can replace the <a class="wikilink" href="http://www.ibexpert.net/ibe/index.php?n=Doc.Table">table</a> and <a class="wikilink" href="http://www.ibexpert.net/ibe/index.php?n=Doc.DefinitionColumn">column</a> details with ones you have set up. 
</p>
<p class="vspace"><strong>Example 1.1: Executing a <code>SELECT</code> query</strong>
</p>
<div class="vspace"></div><pre> // Assume we still have the Connection instance 'con' from the previous example

 try {

 String username = null;
 int userid = 0;

 String sql = "SELECT userid, username FROM users WHERE userid = 10000";

 Statement sment = con.createStatement();

 <span class="wikiword">ResultSet</span> rs = sment.executeQuery(sql);

 if ( rs.next() ) {

 // Calls to rs.next() position the result set to the next available row.
 // You'd use 'while ( rs.next() )' in the case that multiple rows may be returned.
 userid = rs.getInt("userid"); /* the column index can also be used */
 username = rs.getString("username");

 } else {

 // The row does not exist in the database

 }

 rs.close(); /* Perhaps unnecessary as the next line will close the <span class="wikiword">ResultSet</span> too */
 sment.close(); /* But some drivers have resource problems, so its to be safe */

 } catch ( <span class="wikiword">SQLException</span> se ) {

 // Report the problem to the standard error stream:
 System.err.println("Exception performing query: "+se);

 } finally {

 // If we've finished with the connection, close it in the
 // finally clause so it will get closed no matter what.
 // May need to wrap this call in another try..catch block.
    con.close();
 }
</pre><p class="vspace" style="text-align: center;"><a href="http://www.ibexpert.net/ibe/index.php?n=Doc.InterBaseAndJavaMakingTheConnection#t">back to top of page</a> <br clear="all">
</p>
<div class="vspace"></div><h2><a name="ClosingTheConnection" id="ClosingTheConnection"></a>Closing the connection</h2>
<p>To close an active database connection, it is a simple matter of calling the <code>close()</code> method of the <code>Connection</code> class e.g. 
</p>
<div class="vspace"></div><pre> // Assuming 'con' is an active Connection instance:

 try {

 con.close();

 } catch ( <span class="wikiword">SQLException</span> se ) {

 ...

    }
</pre><p class="vspace"><span style="color: green;"><span style="font-size:83%"><em>This paper was written by Joe Shevland and is copyright Joe Shevland and <span class="wikiword">IBPhoenix</span> Inc.</em></span></span>
</p>
<p class="vspace"><span style="color: green;"><ins>See also:</ins></span><br clear="all">
<a class="wikilink" href="http://www.ibexpert.net/ibe/index.php?n=Doc.InterBaseAndJavaStoringAndRetrievingBLOBData">InterBase<sup>®</sup> and Java<sup>®</sup>: storing and retrieving BLOB data</a><br clear="all">
<a class="wikilink" href="http://www.ibexpert.net/ibe/index.php?n=Doc.JavaUDFFunctionalSpecification">Java<sup>®</sup> UDF functional specification</a><br clear="all">
</p>
<p class="vspace" style="text-align: center;"><a href="http://www.ibexpert.net/ibe/index.php?n=Doc.InterBaseAndJavaMakingTheConnection#t">back to top of page</a> <br clear="all">
<span class="trail"><span class="wikitrail">&lt;&lt; <a class="wikilink" href="http://www.ibexpert.net/ibe/index.php?n=Doc.UsingApachePHPAndInterBaseToDevelopWebsites">Using Apache, PHP and InterBase to develop websites</a> | <a class="wikilink" href="http://www.ibexpert.net/ibe/index.php?n=Doc.DatabaseTechnologyArticles">Database technology articles</a> | <a class="wikilink" href="http://www.ibexpert.net/ibe/index.php?n=Doc.InterBaseAndJavaStoringAndRetrievingBLOBData">InterBase and Java: storing and retrieving BLOB data</a> &gt;&gt;</span></span>
</p>
</div>

		</div>

		<div id="right">	<!--DJG: "right2"-->
			<!--PageSearchFmt-->
			<h4>Search</h4>
			<form id="searchform" action="http://www.ibexpert.net/ibe/index.php" method="get"><fieldset>
				<input type="hidden" name="n" value="Doc.InterBaseAndJavaMakingTheConnection">
				<input type="hidden" name="action" value="search">
				<p>
					<input id="s" class="text" type="text" name="q" value="">
					<input id="searchsubmit" class="button" type="submit" value="Go">
				</p>
			</fieldset></form>
			<!--/PageSearchFmt-->

			<!--PageRightFmt-->
			<div class="vspace"></div><ul><li><a target="_blank" class="urllink" href="http://www.ibexpert.net/shop" rel="nofollow">online shop</a> <a target="_blank" class="urllink" href="http://www.ibexpert.net/shop" rel="nofollow"><img width="25px" src="./the database experts Doc InterBase and Java  making the connection_files/cart.png" alt="" title=""></a>
<div class="vspace"></div></li><li><a target="_blank" class="urllink" href="http://www.ibexpert.net/downloadcenter" rel="nofollow">IBExpert download center</a> <a target="_blank" class="urllink" href="http://www.ibexpert.net/downloadcenter" rel="nofollow"><img width="25px" src="./the database experts Doc InterBase and Java  making the connection_files/download.png" alt="" title=""></a>
</li></ul><div class="vspace"></div><hr>
<div class="vspace"></div><ul><li><a class="wikilink" href="http://www.ibexpert.net/ibe/index.php?n=Main.Homepage">home</a>
</li><li><a class="wikilink" href="http://www.ibexpert.net/ibe/index.php?n=Main.OurProducts">products</a>
</li><li><a class="wikilink" href="http://www.ibexpert.net/ibe/index.php?n=Main.Servicesandsupport">services &amp; support</a>
</li><li><a class="wikilink" href="http://www.ibexpert.net/ibe/index.php?n=Main.LicenseSummary">prices</a>
</li><li><a class="wikilink" href="http://www.ibexpert.net/ibe/index.php?n=Main.IBExpertKG">our company</a>
</li></ul><div class="vspace"></div><hr>
<div class="vspace"></div><ul><li><a class="wikilink" href="http://www.ibexpert.net/ibe/index.php?n=Main.Download">download</a>
</li><li><a class="wikilink" href="http://www.ibexpert.net/ibe/index.php?n=Doc.Doc">documentation</a>
</li><li><a class="wikilink" href="http://www.ibexpert.net/ibe/index.php?n=Doc.LearningCenter">learning center</a>
</li><li><a target="_blank" class="urllink" href="http://firebirdexperts.com/" rel="nofollow">forum</a>
</li></ul><div class="vspace"></div><hr>
<div class="vspace"></div><ul><li><a class="urllink" href="http://www.ibexpert.net/ibe_de" rel="nofollow">German</a>
</li></ul><div class="vspace"></div><hr>
<p class="vspace"><span style="font-size:83%"><strong>Folgen Sie <span class="wikiword">IBExpertise</span> auf:</strong></span>
</p>
<div class="vspace"></div><div><span class="cfloat"><a class="urllink" href="https://www.facebook.com/IBExpertise" rel="nofollow"><img width="118px" src="./the database experts Doc InterBase and Java  making the connection_files/Facebook_Logo.gif" alt="" title=""></a></span></div>
<div class="vspace"></div><div><span class="cfloat"><a class="urllink" href="http://twitter.com/IBExpertise" rel="nofollow"><img width="118px" src="./the database experts Doc InterBase and Java  making the connection_files/Twitter_Logo.gif" alt="" title=""></a></span></div>
<div class="vspace"></div><div><span class="cfloat"><a class="urllink" href="http://www.youtube.com/user/IBExpertise" rel="nofollow"><img width="118px" src="./the database experts Doc InterBase and Java  making the connection_files/YouTube_Logo.gif" alt="" title=""></a></span></div>
<p class="vspace"><span style="color: green;"><span style="font-size:83%">COPYRIGHT © 2002-2014 <br><span class="wikiword">IBExpert</span> KG. All rights reserved.</span></span>
</p>
<p class="vspace" style="text-align: right;"> <span style="font-size:83%"><a class="wikilink" href="http://www.ibexpert.net/ibe/index.php?n=Site.SideBar?action=edit">edit SideBar</a></span>
</p>
<div class="vspace"></div><div style="text-align: right;"> <a accesskey="ak_attach" rel="nofollow" class="wikilink" href="http://www.ibexpert.net/ibe/index.php?n=Doc.InterBaseAndJavaMakingTheConnection?action=upload"><img src="./the database experts Doc InterBase and Java  making the connection_files/AttachGreen24.png" alt="" title=""></a> </div>
<div style="text-align: right;"> <a accesskey="" rel="nofollow" class="wikilink" href="http://www.ibexpert.net/ibe/index.php?n=Doc.InterBaseAndJavaMakingTheConnection?action=print"><img src="./the database experts Doc InterBase and Java  making the connection_files/PrinterGreen24.png" alt="" title=""></a> </div>
<div style="text-align: right;"> <a accesskey="e" rel="nofollow" class="wikilink" href="http://www.ibexpert.net/ibe/index.php?n=Doc.InterBaseAndJavaMakingTheConnection?action=edit"><img src="./the database experts Doc InterBase and Java  making the connection_files/WriteGreen24.png" alt="" title=""></a> </div>

			<!--/PageRightFmt-->
		</div>


		<div id="foot">
			<!--PageFooterFmt-->
				<p class="vspace" style="text-align: center;"> <span style="color: green;"><a style="color: green" class="wikilink" href="http://www.ibexpert.net/ibe/index.php?n=Main.Homepage">home</a></span> - <span style="color: green;"><a style="color: green" class="wikilink" href="http://www.ibexpert.net/ibe/index.php?n=Main.Sitemap">site map</a></span> - <span style="color: green;"><a style="color: green" class="wikilink" href="http://www.ibexpert.net/ibe/index.php?n=Main.Contact">contact</a></span> - <span style="color: green;"><a style="color: green" target="_blank" class="urllink" href="http://www.ibexpert.net/shop/" rel="nofollow">online shop</a></span> - <span style="color: green;"><a style="color: green" class="wikilink" href="http://www.ibexpert.net/ibe/index.php?n=Site.Options">order &amp; payment options</a></span> - <span style="color: green;"><a style="color: green" class="wikilink" href="http://www.ibexpert.net/ibe/index.php?n=Main.Registration">registration</a></span> - <span style="color: green;"><a style="color: green" class="wikilink" href="http://www.ibexpert.net/ibe/index.php?n=Main.Legal">legal</a></span> <br> © Copyright <span class="wikiword">IBExpert</span> KG 2002-2014 <br> Page last modified on May 27, 2013, at 02:18 PM MEZ
</p>

			<!--/PageFooterFmt-->
		</div>
	</div>

<!--HTMLFooter-->


</body></html>